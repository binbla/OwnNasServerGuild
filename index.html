<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="é­”æ³•å¯¼èˆªç«™ - å‘ç°è‡ªå»ºç½‘ç»œæœåŠ¡">
    <title>âœ¨ é­”æ³•å¯¼èˆªç«™ âœ¨</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="fontawesome-free-6.7.2-web/css/all.css">
</head>

<body>
    <!-- åŠ è½½åŠ¨ç”»å®¹å™¨ -->
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">é­”æ³•åŠ è½½ä¸­...</div>
    </div>

    <!-- /* æ ‡é¢˜éƒ¨åˆ† */ -->
    <div class="header">
        <h1>
            <span>âœ¨</span><span>é­”</span><span>æ³•</span><span>å¯¼</span><span>èˆª</span><span>ç«™</span><span>âœ¨</span>
        </h1>
        <p>ç‚¹å‡»æ¢ç´¢ç¥å¥‡æœåŠ¡</p>
    </div>

    <!-- /* å¡ç‰‡å®¹å™¨ */ -->
    <div class="container" id="app"></div>
    <!-- /* æ¼‚æµ®å‡ ä½•å›¾å½¢ */ -->
    <div class="shapes">
        <div class="shape circle"></div>
        <div class="shape square"></div>
        <div class="shape triangle"></div>
        <div class="shape circle"></div>
        <div class="shape hexagon"></div>
        <div class="shape star"></div>
        <div class="shape diamond"></div>
        <div class="shape infinity"></div>
        <div class="shape moon"></div>
        <div class="shape oval"></div>
    </div>

    <!-- /* è„šæœ¬éƒ¨åˆ† */ -->
    <script>
        const body = document.body;
        // ç¦æ­¢å³é”®èœå•
        body.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        });

        body.addEventListener('click', function (e) {
            const ripple = document.createElement('div');
            ripple.classList.add('ripple');
            document.body.appendChild(ripple);

            // è·å–æ»šåŠ¨ä½ç½®
            const scrollX = window.scrollX;
            const scrollY = window.scrollY;

            // è®¾ç½®æ¶Ÿæ¼ªçš„ä½ç½®
            const x = e.clientX + scrollX;
            const y = e.clientY + scrollY;

            // åŠ¨æ€è®¾ç½®æ¶Ÿæ¼ªå¤§å°ï¼ŒåŸºäºå±å¹•å¤§å°ï¼ˆç¼©å°ä¸‰å€ï¼‰
            const size = Math.max(window.innerWidth, window.innerHeight) * 0.1; // å¤§å°ä¸ºå±å¹•çš„ 10%
            ripple.style.width = `${size}px`;
            ripple.style.height = `${size}px`;

            // è°ƒæ•´æ¶Ÿæ¼ªå…ƒç´ çš„ä½ç½®ï¼Œä½¿å…¶ä¸­å¿ƒç‚¹ä¸ç‚¹å‡»ä½ç½®å¯¹é½
            ripple.style.left = `${x - size / 2}px`;
            ripple.style.top = `${y - size / 2}px`;

            // åŠ¨ç”»ç»“æŸåç§»é™¤æ¶Ÿæ¼ªå…ƒç´ 
            ripple.addEventListener('animationend', () => {
                ripple.remove();
            });
        });
        // åŠ è½½ config.json å¹¶æ¸²æŸ“å¡ç‰‡
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
                loader.classList.add('active');
                const response = await fetch('config.json');
                const data = await response.json();
                // await new Promise(resolve => setTimeout(resolve, 1500));
                const container = document.querySelector('#app');
                if (!data.length) {
                    container.innerHTML = '<p style="text-align: center; color: white;">æš‚æ— æ•°æ®</p>';
                    return;
                }
                data.forEach(site => {
                    const card = document.createElement('div');
                    card.classList.add('card');
                    // åˆ¤æ–­å›¾æ ‡æ˜¯å›¾ç‰‡è¿˜æ˜¯ Font Icon
                    let iconHTML = '';

                    // ä¼˜å…ˆè€ƒè™‘ fontIcon å­—æ®µ
                    if (site.fontIcon && site.fontIcon !== "") {
                        // å¦‚æœæœ‰ fontIcon å­—æ®µå¹¶ä¸”ä¸ä¸ºç©ºï¼Œæ¸²æŸ“ Font Icon
                        iconHTML = `<i class="card-icon ${site.fontIcon} "></i>`;
                    } else if (site.icon && /\.(jpg|jpeg|png|gif|bmp)$/i.test(site.icon)) {
                        // å¦‚æœæ˜¯å›¾ç‰‡é“¾æ¥
                        iconHTML = `<img src="${site.icon}" alt="${site.name} å›¾æ ‡" class="card-icon" />`;
                    } else {
                        // å¦‚æœæ²¡æœ‰ fontIcon å¹¶ä¸” icon ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤å›¾æ ‡
                        iconHTML = `<img src="default-icon.png" alt="${site.name} å›¾æ ‡" class="card-icon" />`;
                    }
                    // ä½¿ç”¨æ–°ç»“æ„åŒ–çš„ HTML
                    card.innerHTML = `
                        <div class="card-header">
                            ${iconHTML}
                            <h2>${site.name}</h2>
                        </div>
                        <div class="card-url">
                            <a href="${site.url}" target="_blank">${site.url}</a>
                        </div>
                        <div class="card-description">
                            <p>${site.description}</p>
                        </div>
                    `;
                    // å¦‚æœè¦æ•´ä¸ªå¡ç‰‡å¯ç‚¹å‡»ï¼Œå–æ¶ˆä¸‹é¢æ³¨é‡Š
                    // card.addEventListener('click', () => window.open(site.url, '_blank'));
                    // å¹¶å°†ä¸‹é¢ä¸€æ®µæ”¾åˆ°urlçš„<a>æ ‡ç­¾é‡Œé¢
                    // onclick = "event.preventDefault();"
                    container.appendChild(card);
                });
            } catch (error) {
                console.error(error);
                container.innerHTML = `
                    <div class="error-message">
                        <p>ğŸ˜¢ æ•°æ®åŠ è½½å¤±è´¥</p>
                        <button onclick="location.reload()">é‡æ–°åŠ è½½</button>
                    </div>
                    `;
            } finally {
                // æ— è®ºæˆåŠŸä¸å¦éƒ½éšè—åŠ è½½åŠ¨ç”»
                loader.classList.remove('active');
            }
        });
    </script>

</body>

</html>